{
  "entityType" : "DASHBOARD",
  "entity" : {
    "title" : "0.Device Management",
    "image" : null,
    "mobileHide" : false,
    "mobileOrder" : null,
    "configuration" : {
      "description" : "",
      "widgets" : {
        "de26cc9f-41ef-7269-2a8f-901b19a82f02" : {
          "typeFullFqn" : "system.input_widgets.update_server_image_attribute",
          "type" : "latest",
          "sizeX" : 7.5,
          "sizeY" : 3.5,
          "config" : {
            "datasources" : [ {
              "type" : "device",
              "name" : "",
              "deviceId" : "14005d10-afcd-11f0-94c3-f75567048948",
              "dataKeys" : [ {
                "name" : "layout",
                "type" : "attribute",
                "label" : "layout",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.35917952136560916
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY",
                "hideInterval" : false,
                "hideLastInterval" : false,
                "hideQuickInterval" : false
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1761472850728,
                  "endTimeMs" : 1761559250728
                },
                "quickInterval" : "CURRENT_DAY",
                "hideInterval" : false,
                "hideLastInterval" : false,
                "hideFixedInterval" : false,
                "hideQuickInterval" : false
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : true,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "8px",
            "settings" : {
              "showResultMessage" : true,
              "displayPreview" : true,
              "displayClearButton" : false,
              "displayApplyButton" : true,
              "displayDiscardButton" : true
            },
            "title" : "Update server image attribute",
            "dropShadow" : true,
            "enableFullscreen" : false,
            "enableDataExport" : false,
            "widgetStyle" : { },
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "useDashboardTimewindow" : true,
            "showLegend" : false,
            "actions" : { },
            "displayTimewindow" : true
          },
          "row" : 0,
          "col" : 0,
          "id" : "de26cc9f-41ef-7269-2a8f-901b19a82f02"
        },
        "03c441fa-27f7-a5d2-4a2c-54e09b304a94" : {
          "typeFullFqn" : "system.cards.entities_table",
          "type" : "latest",
          "sizeX" : 7.5,
          "sizeY" : 6.5,
          "config" : {
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 86400000,
                "quickInterval" : "CURRENT_DAY",
                "hideInterval" : false,
                "hideLastInterval" : false,
                "hideQuickInterval" : false
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1763440784119,
                  "endTimeMs" : 1763527184119
                },
                "quickInterval" : "CURRENT_DAY",
                "hideInterval" : false,
                "hideLastInterval" : false,
                "hideFixedInterval" : false,
                "hideQuickInterval" : false
              },
              "aggregation" : {
                "type" : "NONE",
                "limit" : 200
              }
            },
            "showTitle" : true,
            "backgroundColor" : "rgb(255, 255, 255)",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "4px",
            "settings" : {
              "entitiesTitle" : "Entities",
              "enableSearch" : true,
              "enableSelectColumnDisplay" : true,
              "enableStickyHeader" : true,
              "enableStickyAction" : true,
              "showCellActionsMenu" : true,
              "reserveSpaceForHiddenAction" : "true",
              "displayEntityName" : false,
              "entityNameColumnTitle" : "",
              "displayEntityLabel" : false,
              "entityLabelColumnTitle" : "",
              "displayEntityType" : false,
              "displayPagination" : true,
              "defaultPageSize" : null,
              "pageStepCount" : 3,
              "pageStepIncrement" : 20,
              "defaultSortOrder" : "name",
              "useRowStyleFunction" : false,
              "rowStyleFunction" : ""
            },
            "title" : "Entities table",
            "dropShadow" : true,
            "enableFullscreen" : true,
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400,
              "padding" : "5px 10px 5px 10px"
            },
            "useDashboardTimewindow" : false,
            "showLegend" : false,
            "datasources" : [ {
              "type" : "entity",
              "name" : "",
              "entityAliasId" : "1693d15b-9396-f342-8fbf-66e69313ba04",
              "filterId" : null,
              "dataKeys" : [ {
                "name" : "name",
                "type" : "entityField",
                "label" : "Name",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.6333360599521173
              }, {
                "name" : "DLU",
                "type" : "attribute",
                "label" : "DLU",
                "color" : "#ff9800",
                "settings" : { },
                "_hash" : 0.889297409364102,
                "decimals" : 0
              }, {
                "name" : "PRPS",
                "type" : "attribute",
                "label" : "PRPS",
                "color" : "#673ab7",
                "settings" : { },
                "_hash" : 0.24944870403925123,
                "decimals" : 0
              }, {
                "name" : "active",
                "type" : "attribute",
                "label" : "active",
                "color" : "#cddc39",
                "settings" : {
                  "customTitle" : "",
                  "columnWidth" : "0px",
                  "useCellStyleFunction" : false,
                  "cellStyleFunction" : "",
                  "useCellContentFunction" : true,
                  "cellContentFunction" : "var color;\r\nvar active = value;\r\nif (active == 'true') { // all key values here are strings\r\n  color = '#27AE60';\r\n} else {\r\n  color = '#EB5757';\r\n}\r\nreturn '<span style=\"font-size: 18px; color: ' + color + '\">&#11044;</span>';\r\n",
                  "defaultColumnVisibility" : "visible",
                  "columnSelectionToDisplay" : "enabled",
                  "disableSorting" : false
                },
                "_hash" : 0.10267183157056603,
                "decimals" : 0,
                "aggregationType" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "connect",
                "type" : "attribute",
                "label" : "connect",
                "color" : "#4caf50",
                "settings" : {
                  "customTitle" : "",
                  "columnWidth" : "0px",
                  "useCellStyleFunction" : false,
                  "cellStyleFunction" : "",
                  "useCellContentFunction" : true,
                  "cellContentFunction" : "var color;\r\nvar active = value;\r\nif (active == 'true') { // all key values here are strings\r\n  color = '#27AE60';\r\n} else {\r\n  color = '#EB5757';\r\n}\r\nreturn '<span style=\"font-size: 18px; color: ' + color + '\">&#11044;</span>';\r\n",
                  "defaultColumnVisibility" : "visible",
                  "columnSelectionToDisplay" : "enabled",
                  "disableSorting" : false
                },
                "_hash" : 0.7682143334866816,
                "decimals" : 0,
                "aggregationType" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "Run",
                "type" : "attribute",
                "label" : "Run",
                "color" : "#009688",
                "settings" : { },
                "_hash" : 0.724124406510095,
                "decimals" : 0
              }, {
                "name" : "Stop",
                "type" : "attribute",
                "label" : "Stop",
                "color" : "#795548",
                "settings" : { },
                "_hash" : 0.9946086208211492,
                "decimals" : 0
              }, {
                "name" : "Error",
                "type" : "attribute",
                "label" : "Error",
                "color" : "#00bcd4",
                "settings" : { },
                "_hash" : 0.5986299012341125,
                "decimals" : 0
              }, {
                "name" : "U1",
                "type" : "attribute",
                "label" : "U1",
                "color" : "#f44336",
                "settings" : { },
                "_hash" : 0.39602857378855283,
                "decimals" : 0
              }, {
                "name" : "U2",
                "type" : "attribute",
                "label" : "U2",
                "color" : "#ffc107",
                "settings" : { },
                "_hash" : 0.39640493582346725,
                "decimals" : 0
              }, {
                "name" : "U3",
                "type" : "attribute",
                "label" : "U3",
                "color" : "#607d8b",
                "settings" : { },
                "_hash" : 0.7150407486486422,
                "decimals" : 0
              }, {
                "name" : "I1",
                "type" : "attribute",
                "label" : "I1",
                "color" : "#9c27b0",
                "settings" : { },
                "_hash" : 0.4791946680202618,
                "decimals" : 0
              }, {
                "name" : "I2",
                "type" : "attribute",
                "label" : "I2",
                "color" : "#8bc34a",
                "settings" : { },
                "_hash" : 0.3836627845694697,
                "decimals" : 0
              }, {
                "name" : "I3",
                "type" : "attribute",
                "label" : "I3",
                "color" : "#3f51b5",
                "settings" : { },
                "_hash" : 0.3626527531946978,
                "decimals" : 0
              }, {
                "name" : "kW",
                "type" : "attribute",
                "label" : "kW",
                "color" : "#e91e63",
                "settings" : { },
                "_hash" : 0.7553611272207796,
                "decimals" : 0
              }, {
                "name" : "PF",
                "type" : "attribute",
                "label" : "PF",
                "color" : "#03a9f4",
                "settings" : { },
                "_hash" : 0.06146260187647545,
                "decimals" : 0
              }, {
                "name" : "kWh",
                "type" : "timeseries",
                "label" : "kWh",
                "color" : "#ffeb3b",
                "settings" : { },
                "_hash" : 0.7382377311849064,
                "decimals" : 0
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "displayTimewindow" : false,
            "configMode" : "advanced",
            "actions" : {
              "headerButton" : [ {
                "name" : "Download",
                "buttonType" : "icon",
                "icon" : "download",
                "buttonColor" : null,
                "customButtonStyle" : { },
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "customPretty",
                "customHtml" : "",
                "customCss" : "",
                "customFunction" : "//Phiên bản download hoàn chỉnh\r\nlet data_widget = widgetContext.data;\r\nlet lengData = 0;\r\nlet rowMax = 0;\r\nlet data_export = [];\r\nlet data_head = [\"Thời gian\"];\r\nfor (i = 0; i < data_widget.length; i++) {\r\n    data_head.push(data_widget[i].dataKey.label);\r\n    if(data_widget[i].data.length > lengData){\r\n        lengData = data_widget[i].data.length;\r\n        rowMax = i;\r\n    }\r\n}\r\ndata_export.push(data_head);\r\n\r\nfor (i = 0; i < lengData; i++) {\r\n    let data_row = [];\r\n    data_row.push(timeconver(data_widget[rowMax].data[i][0]));\r\n    for (j = 0; j < data_widget.length; j++) {\r\n        let data_push = 0;\r\n        for (k=0; k < data_widget[j].data.length; k++){\r\n            if (data_widget[j].data[k][0] == data_widget[rowMax].data[i][0]) {\r\n                data_push = data_widget[j].data[k][1];\r\n            }\r\n        }\r\n        data_row.push(data_push);\r\n    }\r\n    data_export.push(data_row);\r\n}\r\n\r\nfunction timeconver(timets) {\r\n    var newdate = new Date(timets);\r\n    var dateStr = newdate.getDate() + \"/\" + (newdate\r\n            .getMonth() + 1) + \"/\" + newdate.getFullYear() +\r\n        \" \" + newdate.getHours() + \":\" + newdate\r\n        .getMinutes() + \":\" + newdate.getSeconds();\r\n    return dateStr;\r\n}\r\n\r\nlet wb = XLSX.utils.book_new();\r\nwb.Props = {\r\n    Title: \"Kikai\",\r\n    Subject: \"Data_export\"\r\n};\r\n\r\nwb.SheetNames.push(\"Data\");\r\n\r\nvar ws = XLSX.utils.aoa_to_sheet(data_export);\r\nwb.Sheets[\"Data\"] = ws;\r\nvar wbout = XLSX.write(wb, {\r\n    bookType: 'xlsx',\r\n    type: 'binary'\r\n});\r\n\r\nfunction s2ab(s) {\r\n    var buf = new ArrayBuffer(s.length);\r\n    var view = new Uint8Array(buf);\r\n    for (var i = 0; i < s.length; i++) view[i] = s\r\n        .charCodeAt(i) & 0xFF;\r\n    return buf;\r\n}\r\n\r\nsaveAs(new Blob([s2ab(wbout)], {\r\n    type: \"application/octet-stream\"\r\n}), 'Energy Data export.xlsx');",
                "customResources" : [ {
                  "url" : "https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.6/xlsx.core.min.js"
                }, {
                  "url" : "https://cdnjs.cloudflare.com/ajax/libs/amcharts/3.21.15/plugins/export/libs/FileSaver.js/FileSaver.min.js"
                } ],
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "840c3e99-657b-3de1-0e7d-2398694d004f"
              } ]
            },
            "showTitleIcon" : false,
            "titleIcon" : "list",
            "iconColor" : null,
            "titleFont" : null,
            "titleColor" : null
          },
          "row" : 0,
          "col" : 0,
          "id" : "03c441fa-27f7-a5d2-4a2c-54e09b304a94"
        }
      },
      "states" : {
        "default" : {
          "name" : "Edit",
          "root" : true,
          "layouts" : {
            "main" : {
              "widgets" : {
                "de26cc9f-41ef-7269-2a8f-901b19a82f02" : {
                  "sizeX" : 7,
                  "sizeY" : 3,
                  "row" : 12,
                  "col" : 0
                },
                "03c441fa-27f7-a5d2-4a2c-54e09b304a94" : {
                  "sizeX" : 24,
                  "sizeY" : 12,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "layoutType" : "default",
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%"
              }
            }
          }
        }
      },
      "entityAliases" : {
        "1693d15b-9396-f342-8fbf-66e69313ba04" : {
          "id" : "1693d15b-9396-f342-8fbf-66e69313ba04",
          "alias" : "e meter",
          "filter" : {
            "type" : "deviceType",
            "resolveMultiple" : true,
            "deviceTypes" : [ "Electricity meter", "TBA" ],
            "deviceNameFilter" : ""
          }
        }
      },
      "filters" : { },
      "timewindow" : {
        "displayValue" : "",
        "hideAggregation" : false,
        "hideAggInterval" : false,
        "hideTimezone" : false,
        "selectedTab" : 0,
        "realtime" : {
          "realtimeType" : 0,
          "interval" : 1000,
          "timewindowMs" : 60000,
          "quickInterval" : "CURRENT_DAY",
          "hideInterval" : false,
          "hideLastInterval" : false,
          "hideQuickInterval" : false
        },
        "history" : {
          "historyType" : 0,
          "interval" : 1000,
          "timewindowMs" : 60000,
          "fixedTimewindow" : {
            "startTimeMs" : 1761472817506,
            "endTimeMs" : 1761559217506
          },
          "quickInterval" : "CURRENT_DAY",
          "hideInterval" : false,
          "hideLastInterval" : false,
          "hideFixedInterval" : false,
          "hideQuickInterval" : false
        },
        "aggregation" : {
          "type" : "AVG",
          "limit" : 25000
        }
      },
      "settings" : {
        "stateControllerId" : "entity",
        "showTitle" : false,
        "showDashboardsSelect" : true,
        "showEntitiesSelect" : true,
        "showDashboardTimewindow" : true,
        "showDashboardExport" : true,
        "toolbarAlwaysOpen" : true
      }
    },
    "name" : "0.Device Management",
    "resources" : null,
    "assignedCustomers" : [ ],
    "externalId" : null,
    "id" : {
      "entityType" : "DASHBOARD",
      "id" : "bd22d1b0-b31b-11f0-afdd-9b977a7eeb3b"
    }
  },
  "relations" : [ ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}